
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Simulation &#8212; Stochastic Matching 0.4.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/vis-network/styles/vis-network.min.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=6c02275b"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=6dbb43f8"></script>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/simulator';</script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Common" href="common.html" />
    <link rel="prev" title="Display" href="display.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.4.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/sm_logo_short.png" class="logo__image only-light" alt="Stochastic Matching 0.4.0 documentation - Home"/>
    <img src="../_static/sm_logo_short.png" class="logo__image only-dark pst-js-only" alt="Stochastic Matching 0.4.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../presentation.html">
    Presentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../companion/index.html">
    A polytope perspective
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/balouf/stochastic_matching" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../presentation.html">
    Presentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../companion/index.html">
    A polytope perspective
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/balouf/stochastic_matching" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="graphs.html">Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="display.html">Display</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Simulation</a></li>





<li class="toctree-l1"><a class="reference internal" href="common.html">Common</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Simulation</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="simulation">
<h1>Simulation<a class="headerlink" href="#simulation" title="Link to this heading">#</a></h1>
<section id="module-stochastic_matching.simulator.longest">
<span id="longest-queue-s-first"></span><h2>Longest queue(s) first<a class="headerlink" href="#module-stochastic_matching.simulator.longest" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.longest.Longest">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.longest.</span></span><span class="sig-name descname"><span class="pre">Longest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_rewards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/longest.html#Longest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.longest.Longest" title="Link to this definition">#</a></dt>
<dd><p>Matching simulator derived from <a class="reference internal" href="#stochastic_matching.simulator.extended.ExtendedSimulator" title="stochastic_matching.simulator.extended.ExtendedSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedSimulator</span></code></a>.
By default, the policy is greedy and whenever multiple edges are actionable,
the longest queue (sum of queues of adjacent nodes) is chosen.</p>
<p>Multiple options are available to tweak this behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>shift_rewards</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default=True) – Longest only selects edges with a positive score. By default, all actionable edges have a positive score,
which makes the policy greedy. However, if negative rewards are added into the mix, this is not True anymore.
Setting shift_rewards to True ensures that default edge scores are non-negative so reward-based selection
is greedy. Setting it to False enables a non-greedy reward-based selection.</p></li>
<li><p><strong>**kwargs</strong> – Keyword parameters of <a class="reference internal" href="#stochastic_matching.simulator.extended.ExtendedSimulator" title="stochastic_matching.simulator.extended.ExtendedSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedSimulator</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let’s start with a working triangle. Not that the results are the same for all greedy simulator because
there are no decision in a triangle (always at most one non-empty queue under a greedy policy).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">Longest</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [287 338 375]</span>
<span class="go">Traffic: [125 162 213]</span>
<span class="go">Queues: [[838 104  41  13   3   1   0   0   0   0]</span>
<span class="go"> [796 119  53  22   8   2   0   0   0   0]</span>
<span class="go"> [640 176  92  51  24   9   5   3   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>A non stabilizable diamond (simulation ends before completion due to drift).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">Longest</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [85 82 85 86]</span>
<span class="go">Traffic: [38 38  7 37 40]</span>
<span class="go">Queues: [[126  74  28  37  21  32  16   1   2   1]</span>
<span class="go"> [326   8   3   1   0   0   0   0   0   0]</span>
<span class="go"> [321  12   4   1   0   0   0   0   0   0]</span>
<span class="go"> [ 90  80  47  37  37  23  11   3   5   5]]</span>
<span class="go">Steps done: 338</span>
</pre></div>
</div>
<p>A stabilizable candy (but candies are not good for greedy policies).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">Longest</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">HyperPaddle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [46 26 32 37 70 35 45]</span>
<span class="go">Traffic: [24 17  2 23 33 12 13]</span>
<span class="go">Queues: [[ 23  32  45  38  22  43  31  34  20   3   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [290   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [290   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [ 9   1   7   9   3   3  26  37   4   8  10   9   2  10  40  11   2  16</span>
<span class="go">    3   3  21  27  22   1   7]</span>
<span class="go"> [212  49  22   5   3   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [233  41   6   7   4   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [231  33  16   4   6   1   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 291</span>
</pre></div>
</div>
<p>Using greedy rewards-based longest (insprired by Stolyar EGCD technique), one can try to reach some vertices.</p>
<p>That works for the Fish graph:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">KayakPaddle</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">Longest</span><span class="p">(</span><span class="n">fish</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The flow avoids one edge:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">flow</span>
<span class="go">array([2.8764, 1.089 , 1.0008, 0.    , 0.8532, 2.079 , 1.0062])</span>
</pre></div>
</div>
<p>The price is one node having a big queue:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avg_queues</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_queues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">np.float64(61.1767)</span>
</pre></div>
</div>
<p>Other nodes are not affected:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_queues</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">np.float64(0.7362)</span>
</pre></div>
</div>
<p>Playing with the beta parameter allows to adjust the trade-off (smaller queue, leak on the forbidden edge):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">Longest</span><span class="p">(</span><span class="n">fish</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">flow</span>
<span class="go">array([2.9574, 1.008 , 0.9198, 0.018 , 0.9972, 2.061 , 1.0242])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">np.float64(8.4628)</span>
</pre></div>
</div>
<p>Alternatively, one can use the k-filtering techniques:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([0.   , 0.954, 0.966, 0.954, 0.   ])</span>
</pre></div>
</div>
<p>Same result can be achieved by putting low rewards on 0 and 4 and settings forbidden_edges to True.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([0.   , 0.954, 0.966, 0.954, 0.   ])</span>
</pre></div>
</div>
<p>Note that if the threshold is too low some exceptions are done to limit the queue sizes.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([0.108, 0.93 , 0.966, 0.93 , 0.024])</span>
</pre></div>
</div>
<p>Having no relaxation usually leads to large, possibly overflowing, queues.
However, this doesn’t show on small simulations.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([7.515, 7.819, 1.067, 1.363])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([0.   , 0.954, 0.966, 0.954, 0.   ])</span>
</pre></div>
</div>
<p>To compare with the priority-based pure greedy version:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([0.444, 0.63 , 0.966, 0.63 , 0.324])</span>
</pre></div>
</div>
<p>We get similar results with Stolyar greedy longest:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([0.444, 0.63 , 0.966, 0.63 , 0.324])</span>
</pre></div>
</div>
<p>However, if you remove the greedyness, you can converge to the vertex:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">shift_rewards</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([0.   , 0.954, 0.966, 0.954, 0.   ])</span>
</pre></div>
</div>
<p>Another example with other rates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Optimize with the first and last edges that provide less reward.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([3.264, 0.888, 0.948, 0.84 , 0.   ])</span>
</pre></div>
</div>
<p>Increase the reward on the first edge.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([4.152, 0.   , 0.996, 0.   , 0.84 ])</span>
</pre></div>
</div>
<p>On bijective graphs, no edge is forbidden whatever the weights.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">paw</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Tadpole</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paw</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">paw</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([1.048, 1.056, 1.016, 0.88 ])</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.longest.Longest.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'longest'</span></em><a class="headerlink" href="#stochastic_matching.simulator.longest.Longest.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.longest.Longest.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/longest.html#Longest.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.longest.Longest.run" title="Link to this definition">#</a></dt>
<dd><p>Run simulation.
Results are stored in the attribute <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator.logs" title="stochastic_matching.simulator.simulator.Simulator.logs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">logs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.longest.Longest.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/longest.html#Longest.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.longest.Longest.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.longest.longest_core">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.longest.</span></span><span class="sig-name descname"><span class="pre">longest_core</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrivals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forbidden_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/longest.html#longest_core"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.longest.longest_core" title="Link to this definition">#</a></dt>
<dd><p>Jitted function for policies based on longest-queue first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs</strong> (<a class="reference internal" href="#stochastic_matching.simulator.logs.Logs" title="stochastic_matching.simulator.logs.Logs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logs</span></code></a>) – Monitored variables.</p></li>
<li><p><strong>arrivals</strong> (<a class="reference internal" href="#stochastic_matching.simulator.arrivals.Arrivals" title="stochastic_matching.simulator.arrivals.Arrivals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Arrivals</span></code></a>) – Item arrival process.</p></li>
<li><p><strong>graph</strong> (<a class="reference internal" href="#stochastic_matching.simulator.graph.JitHyperGraph" title="stochastic_matching.simulator.graph.JitHyperGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">JitHyperGraph</span></code></a>) – Model graph.</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of arrivals to process.</p></li>
<li><p><strong>queue_size</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Number of waiting items of each class.</p></li>
<li><p><strong>scores</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Default value for edges. Enables EGPD-like selection mechanism.</p></li>
<li><p><strong>forbidden_edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, optional) – Edges that are disabled.</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Queue size above which forbidden edges become available again.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-stochastic_matching.simulator.virtual_queue">
<span id="virtual-queue-policy"></span><h2>Virtual queue policy<a class="headerlink" href="#module-stochastic_matching.simulator.virtual_queue" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.virtual_queue.VirtualQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.virtual_queue.</span></span><span class="sig-name descname"><span class="pre">VirtualQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_edge_queue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/virtual_queue.html#VirtualQueue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue" title="Link to this definition">#</a></dt>
<dd><p>Non-Greedy Matching simulator derived from <a class="reference internal" href="#stochastic_matching.simulator.extended.ExtendedSimulator" title="stochastic_matching.simulator.extended.ExtendedSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedSimulator</span></code></a>.
Always pick-up the best edge according to a scoring function, even if that edge cannot be used (yet).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>max_edge_queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – In some extreme situation, the default allocated space for the edge virtual queue may be too small.
If that happens someday, use this parameter to increase the VQ allocated memory.</p></li>
<li><p><strong>**kwargs</strong> – Keyword parameters of <a class="reference internal" href="#stochastic_matching.simulator.extended.ExtendedSimulator" title="stochastic_matching.simulator.extended.ExtendedSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedSimulator</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let start with a working triangle.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [287 338 375]</span>
<span class="go">Traffic: [125 162 213]</span>
<span class="go">Queues: [[837 105  41  13   3   1   0   0   0   0]</span>
<span class="go"> [784 131  53  22   8   2   0   0   0   0]</span>
<span class="go"> [629 187  92  51  24   9   5   3   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Unstable diamond (simulation ends before completion due to drift).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [85 82 85 86]</span>
<span class="go">Traffic: [34 42  7 41 36]</span>
<span class="go">Queues: [[141  55  34  25  23  16  24  12   7   1]</span>
<span class="go"> [318  16   3   1   0   0   0   0   0   0]</span>
<span class="go"> [316  17   4   1   0   0   0   0   0   0]</span>
<span class="go"> [106  67  64  37  22  24   7   3   6   2]]</span>
<span class="go">Steps done: 338</span>
</pre></div>
</div>
<p>Stable diamond without reward optimization:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [179 342 320 159]</span>
<span class="go">Traffic: [ 95  84 161  84  75]</span>
<span class="go">Queues: [[823 120  38  19   0   0   0   0   0   0]</span>
<span class="go"> [625 215  76  46  28   9   1   0   0   0]</span>
<span class="go"> [686 212  70  24   7   1   0   0   0   0]</span>
<span class="go"> [823 118  39  12   4   4   0   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Let’s optimize (kill traffic on first and last edges).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [22 51 55 27]</span>
<span class="go">Traffic: [ 0 22 24 27  0]</span>
<span class="go">Queues: [[136  16   3   0   0   0   0   0   0   0]</span>
<span class="go"> [112  14   8   6   7   4   3   1   0   0]</span>
<span class="go"> [ 73  21  13   7   9   8   4   5  12   3]</span>
<span class="go"> [105  31  11   5   2   1   0   0   0   0]]</span>
<span class="go">Steps done: 155</span>
</pre></div>
</div>
<p>OK, it’s working, but we reached the maximal queue size quite fast. Let’s reduce the pressure.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="n">beta</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [179 342 320 159]</span>
<span class="go">Traffic: [ 32 146 161 146  13]</span>
<span class="go">Queues: [[691 222  68  18   1   0   0   0   0   0]</span>
<span class="go"> [514 153 123 110  48  32  16   4   0   0]</span>
<span class="go"> [662 136  91  62  38   4   2   2   2   1]</span>
<span class="go"> [791 128  50  18   7   6   0   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Let’s play a bit with alt rewards, starting with adversarial rewards:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">beta</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [179 342 320 159]</span>
<span class="go">Traffic: [ 70 109 161 109  50]</span>
<span class="go">Queues: [[664 213  84  28   8   3   0   0   0   0]</span>
<span class="go"> [460 247 135  70  50  25  10   3   0   0]</span>
<span class="go"> [824 122  38  10   5   1   0   0   0   0]</span>
<span class="go"> [902  71  20   7   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>With those rewards, we are far from the target. Let’s be gentle:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">alt_rewards</span><span class="o">=</span><span class="s2">&quot;gentle&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">gentle_rewards</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span>
<span class="go">array([-2,  2,  2,  2, -2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [29 58 68 32]</span>
<span class="go">Traffic: [ 0 29 29 29  1]</span>
<span class="go">Queues: [[168  16   3   0   0   0   0   0   0   0]</span>
<span class="go"> [143  15   9   5   7   4   3   1   0   0]</span>
<span class="go"> [ 70  24  16   9  22  18  11   8   4   5]</span>
<span class="go"> [ 95  32  23  10  19   7   1   0   0   0]]</span>
<span class="go">Steps done: 187</span>
</pre></div>
</div>
<p>OK, it works but pressure is restored. Let’s normalize:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">alt_rewards</span><span class="o">=</span><span class="s2">&quot;normalize&quot;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">normalize_rewards</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span>
<span class="go">array([ 0. ,  0. ,  0. ,  0. , -0.1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [179 342 320 159]</span>
<span class="go">Traffic: [ 95  84 161  84  75]</span>
<span class="go">Queues: [[823 120  38  19   0   0   0   0   0   0]</span>
<span class="go"> [625 215  76  46  28   9   1   0   0   0]</span>
<span class="go"> [686 212  70  24   7   1   0   0   0   0]</span>
<span class="go"> [823 118  39  12   4   4   0   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Not enough pressure in this example!</p>
<p>Let’s now use a k-filtering approach for this diamond:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [27 57 65 31]</span>
<span class="go">Traffic: [ 0 27 29 28  0]</span>
<span class="go">Queues: [[158  16   3   3   0   0   0   0   0   0]</span>
<span class="go"> [136  19   8   4   5   4   3   1   0   0]</span>
<span class="go"> [ 70  25  13  14  12  15  21   8   1   1]</span>
<span class="go"> [ 96  24  13  12   9  16   8   2   0   0]]</span>
<span class="go">Steps done: 180</span>
</pre></div>
</div>
<p>Let us reduce the pressure.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [179 342 320 159]</span>
<span class="go">Traffic: [ 31 145 161 145  14]</span>
<span class="go">Queues: [[600 171 122  81  20   6   0   0   0   0]</span>
<span class="go"> [444 151 137 104  81  65  14   4   0   0]</span>
<span class="go"> [698  83  52  59  57  38   7   3   2   1]</span>
<span class="go"> [730 130  64  35  26   9   2   4   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>A stable candy. While candies are not good for greedy policies, the virtual queue is
designed to deal with it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">HyperPaddle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [140 126 154 112 224 121 123]</span>
<span class="go">Traffic: [109  29  17  59  58  62 107]</span>
<span class="go">Queues: [[301  83  94  83  54  60  43  48  41  32  49  60  31   3   8   7   3   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [825 101  27  14  26   7   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [899  64  20   8   9   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [110  49  93 108 120 102  48  28  53  32   7  30  16  42  28  34  31  30</span>
<span class="go">   26  11   2   0   0   0   0]</span>
<span class="go"> [276 185 151  95  60  40  49  52  47  33  12   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [755 142  67  36   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [709 228  47  13   3   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Last but not least: Stolyar’s example from <a class="reference external" href="https://arxiv.org/abs/1608.01646">https://arxiv.org/abs/1608.01646</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stol</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">incidence</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">.8</span><span class="p">])</span>
</pre></div>
</div>
<p>Without optimization, all we do is self-matches (no queue at all):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">stol</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([236, 279, 342, 143,   0,   0,   0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([0., 0., 0., 0.])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<p>With optimization, we get the desired results at the price of a huge queue:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">stol</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.01</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([  0,   0, 761, 242, 591,   0, 205])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([86.17266667,  0.53233333, 93.03      ,  0.33533333])</span>
</pre></div>
</div>
<p>Same traffic could be achieved with much lower queues by enforcing forbidden edges:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">stol</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([  0,   0, 961, 342, 691,   0, 105])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([2.731     , 0.69633333, 0.22266667, 0.052     ])</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.virtual_queue.VirtualQueue.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'virtual_queue'</span></em><a class="headerlink" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.virtual_queue.VirtualQueue.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/virtual_queue.html#VirtualQueue.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue.run" title="Link to this definition">#</a></dt>
<dd><p>Run simulation.
Results are stored in the attribute <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator.logs" title="stochastic_matching.simulator.simulator.Simulator.logs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">logs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.virtual_queue.VirtualQueue.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/virtual_queue.html#VirtualQueue.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.virtual_queue.vq_core">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.virtual_queue.</span></span><span class="sig-name descname"><span class="pre">vq_core</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrivals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forbidden_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/virtual_queue.html#vq_core"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.virtual_queue.vq_core" title="Link to this definition">#</a></dt>
<dd><p>Jitted function for virtual-queue policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs</strong> (<a class="reference internal" href="#stochastic_matching.simulator.logs.Logs" title="stochastic_matching.simulator.logs.Logs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logs</span></code></a>) – Monitored variables.</p></li>
<li><p><strong>arrivals</strong> (<a class="reference internal" href="#stochastic_matching.simulator.arrivals.Arrivals" title="stochastic_matching.simulator.arrivals.Arrivals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Arrivals</span></code></a>) – Item arrival process.</p></li>
<li><p><strong>graph</strong> (<a class="reference internal" href="#stochastic_matching.simulator.graph.JitHyperGraph" title="stochastic_matching.simulator.graph.JitHyperGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">JitHyperGraph</span></code></a>) – Model graph.</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of arrivals to process.</p></li>
<li><p><strong>queue_size</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Number of waiting items of each class.</p></li>
<li><p><strong>scores</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Default value for edges. Enables EGPD-like selection mechanism.</p></li>
<li><p><strong>ready_edges</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Tells if given edge is actionable.</p></li>
<li><p><strong>edge_queue</strong> (<a class="reference internal" href="#stochastic_matching.simulator.multiqueue.MultiQueue" title="stochastic_matching.simulator.multiqueue.MultiQueue"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiQueue</span></code></a>) – Edges waiting to be matched.</p></li>
<li><p><strong>forbidden_edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, optional) – Edges that are disabled.</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Queue size above which forbidden edges become available again.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-stochastic_matching.simulator.constant_regret">
<dt class="sig sig-object py" id="stochastic_matching.simulator.constant_regret.ConstantRegret">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.constant_regret.</span></span><span class="sig-name descname"><span class="pre">ConstantRegret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fading</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_edge_queue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/constant_regret.html#ConstantRegret"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.constant_regret.ConstantRegret" title="Link to this definition">#</a></dt>
<dd><p>Non-Greedy Matching simulator that implements <a class="reference external" href="https://sophieyu.me/constant_regret_matching.pdf">https://sophieyu.me/constant_regret_matching.pdf</a>
Always pick-up the best positive edge according to a scoring function, even if that edge cannot be used (yet).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>rewards</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Edge rewards.</p></li>
<li><p><strong>fading</strong> (<em>callable</em>) – Jitted function that drives reward relative weight.</p></li>
<li><p><strong>max_edge_queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – In some extreme situation, the default allocated space for the edge virtual queue may be too small.
If that happens someday, use this parameter to increase the VQ allocated memory.</p></li>
<li><p><strong>**kwargs</strong> – Keyword parameters of <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let start with a working triangle.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [287 338 375]</span>
<span class="go">Traffic: [125 162 213]</span>
<span class="go">Queues: [[837 105  41  13   3   1   0   0   0   0]</span>
<span class="go"> [784 131  53  22   8   2   0   0   0   0]</span>
<span class="go"> [629 187  92  51  24   9   5   3   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Unstable diamond (simulation ends before completion due to drift).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [85 82 85 86]</span>
<span class="go">Traffic: [34 42  7 41 36]</span>
<span class="go">Queues: [[141  55  34  25  23  16  24  12   7   1]</span>
<span class="go"> [318  16   3   1   0   0   0   0   0   0]</span>
<span class="go"> [316  17   4   1   0   0   0   0   0   0]</span>
<span class="go"> [106  67  64  37  22  24   7   3   6   2]]</span>
<span class="go">Steps done: 338</span>
</pre></div>
</div>
<p>Stable diamond without reward optimization:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [179 342 320 159]</span>
<span class="go">Traffic: [ 95  84 161  84  75]</span>
<span class="go">Queues: [[823 120  38  19   0   0   0   0   0   0]</span>
<span class="go"> [625 215  76  46  28   9   1   0   0   0]</span>
<span class="go"> [686 212  70  24   7   1   0   0   0   0]</span>
<span class="go"> [823 118  39  12   4   4   0   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Let’s optimize (kill traffic on first and last edges).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [20 44 51 23]</span>
<span class="go">Traffic: [ 3 17 25 16  0]</span>
<span class="go">Queues: [[136   2   0   0   0   0   0   0   0   0]</span>
<span class="go"> [127   4   6   1   0   0   0   0   0   0]</span>
<span class="go"> [ 24  22   9  13  14  20  16  13   4   3]</span>
<span class="go"> [ 40  17  22  21  22  14   1   1   0   0]]</span>
<span class="go">Steps done: 138</span>
</pre></div>
</div>
<p>OK, it’s mostly working, but we reached the maximal queue size quite fast. Let’s reduce the pressure.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">slow_fading</span> <span class="o">=</span> <span class="n">njit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">rewards</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="n">fading</span><span class="o">=</span><span class="n">slow_fading</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [179 342 320 159]</span>
<span class="go">Traffic: [ 43 136 161 136  23]</span>
<span class="go">Queues: [[900  79  18   2   1   0   0   0   0   0]</span>
<span class="go"> [840  98  37  17   6   2   0   0   0   0]</span>
<span class="go"> [483 224 122  78  61  26   5   1   0   0]</span>
<span class="go"> [551 255 100  50  25  10   9   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>A stable candy. While candies are not good for greedy policies, virtual queues policies are
designed to deal with it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">HyperPaddle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [140 126 154 112 224 121 123]</span>
<span class="go">Traffic: [109  29  17  59  58  62 107]</span>
<span class="go">Queues: [[301  83  94  83  54  60  43  48  41  32  49  60  31   3   8   7   3   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [825 101  27  14  26   7   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [899  64  20   8   9   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [110  49  93 108 120 102  48  28  53  32   7  30  16  42  28  34  31  30</span>
<span class="go">   26  11   2   0   0   0   0]</span>
<span class="go"> [276 185 151  95  60  40  49  52  47  33  12   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [755 142  67  36   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [709 228  47  13   3   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Last but not least: Stolyar’s example from <a class="reference external" href="https://arxiv.org/abs/1608.01646">https://arxiv.org/abs/1608.01646</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">NS19</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">.8</span><span class="p">])</span>
</pre></div>
</div>
<p>Without optimization, all we do is self-matches (no queue at all):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([236, 279, 342, 143,   0,   0,   0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([0., 0., 0., 0.])</span>
</pre></div>
</div>
<p>Let’s introduce some rewards:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">optimize_rates</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span>
<span class="go">array([0. , 0. , 1.7, 0.5, 1.2, 0. , 0.3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">normalize_rewards</span><span class="p">(</span><span class="n">rewards</span><span class="p">)</span>
<span class="go">array([-2., -5.,  0.,  0.,  0., -1.,  0.])</span>
</pre></div>
</div>
<p>With optimization, we get the desired results:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">ConstantRegret</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([  0,   0, 961, 342, 691,   0, 105])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([2.731     , 0.69633333, 0.22266667, 0.052     ])</span>
</pre></div>
</div>
<p>One can check that this is the same as using a regular virtual queue with forbidden edges:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">stochastic_matching.simulator.virtual_queue</span><span class="w"> </span><span class="kn">import</span> <span class="n">VirtualQueue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">VirtualQueue</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">3000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([  0,   0, 961, 342, 691,   0, 105])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([2.731     , 0.69633333, 0.22266667, 0.052     ])</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.constant_regret.ConstantRegret.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'constant_regret'</span></em><a class="headerlink" href="#stochastic_matching.simulator.constant_regret.ConstantRegret.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.constant_regret.ConstantRegret.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/constant_regret.html#ConstantRegret.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.constant_regret.ConstantRegret.run" title="Link to this definition">#</a></dt>
<dd><p>Run simulation.
Results are stored in the attribute <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator.logs" title="stochastic_matching.simulator.simulator.Simulator.logs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">logs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.constant_regret.ConstantRegret.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/constant_regret.html#ConstantRegret.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.constant_regret.ConstantRegret.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.constant_regret.cr_core">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.constant_regret.</span></span><span class="sig-name descname"><span class="pre">cr_core</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrivals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ready_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fading</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/constant_regret.html#cr_core"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.constant_regret.cr_core" title="Link to this definition">#</a></dt>
<dd><p>Jitted function for constant-regret policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs</strong> (<a class="reference internal" href="#stochastic_matching.simulator.logs.Logs" title="stochastic_matching.simulator.logs.Logs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logs</span></code></a>) – Monitored variables.</p></li>
<li><p><strong>arrivals</strong> (<a class="reference internal" href="#stochastic_matching.simulator.arrivals.Arrivals" title="stochastic_matching.simulator.arrivals.Arrivals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Arrivals</span></code></a>) – Item arrival process.</p></li>
<li><p><strong>graph</strong> (<a class="reference internal" href="#stochastic_matching.simulator.graph.JitHyperGraph" title="stochastic_matching.simulator.graph.JitHyperGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">JitHyperGraph</span></code></a>) – Model graph.</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of arrivals to process.</p></li>
<li><p><strong>queue_size</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Number of waiting items of each class.</p></li>
<li><p><strong>scores</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Normalized edge rewards (&lt;0 on taboo edges). Enables EGPD-like selection mechanism.</p></li>
<li><p><strong>ready_edges</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Tells if given edge is actionable.</p></li>
<li><p><strong>edge_queue</strong> (<a class="reference internal" href="#stochastic_matching.simulator.multiqueue.MultiQueue" title="stochastic_matching.simulator.multiqueue.MultiQueue"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiQueue</span></code></a>) – Edges waiting to be matched.</p></li>
<li><p><strong>fading</strong> (<em>callable</em>) – Jitted function that drives reward relative weight.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.constant_regret.lin_fading">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.constant_regret.</span></span><span class="sig-name descname"><span class="pre">lin_fading</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/constant_regret.html#lin_fading"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.constant_regret.lin_fading" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Step index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Step index + 1</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="module-stochastic_matching.simulator.e_filtering">
<span id="epsilon-filtering-policy"></span><h1>Epsilon-Filtering policy<a class="headerlink" href="#module-stochastic_matching.simulator.e_filtering" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.e_filtering.EFiltering">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.e_filtering.</span></span><span class="sig-name descname"><span class="pre">EFiltering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'longest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forbidden_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">base_policy_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/e_filtering.html#EFiltering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.e_filtering.EFiltering" title="Link to this definition">#</a></dt>
<dd><p>Epsilon-filtering policy where incoming items are tagged with a spin.
A match on a forbidden edge requires at least one “+” item.
In practice, the simulator works on an expanded graph with twice the initial nodes to represent “+” and “-“.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>base_policy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Type of simulator to instantiate. Cannot have mandatory extra-parameters (e.g. NOT ‘priority’).</p></li>
<li><p><strong>forbidden_edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, optional) – Edges that should not be used.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, optional) – Target rewards on edges. If weights are given, the forbidden edges are computed to match the target
(overrides forbidden_edges argument).</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, default=.01) – Proportion of “+” arrivals (lower means less odds to select a forbidden edge).</p></li>
<li><p><strong>**base_policy_kwargs</strong> – Keyword arguments. Only universal parameters should be used (seed, max_queue, n_steps).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Consider the following diamond graph with injective vertex [1, 2, 3]:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>Without any specific argument, epsilon-filtering acts as a regular longest policy:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">EFiltering</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span>
<span class="go">Arrivals: [162 342 348 148]</span>
<span class="go">Traffic: [ 76  86 190  76  72]</span>
<span class="go">Queues: [[882  91  23 ...   0   0   0]</span>
<span class="go"> [661 109  72 ...   0   0   0]</span>
<span class="go"> [737 111  63 ...   0   0   0]</span>
<span class="go"> [870  96  27 ...   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Let us use epsilon-filtering by specifying forbidden_edges:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">EFiltering</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span>
<span class="go">Arrivals: [162 342 348 148]</span>
<span class="go">Traffic: [  1 158 189 147   1]</span>
<span class="go">Queues: [[571  44  61 ...   0   0   0]</span>
<span class="go"> [560  37  52 ...   0   0   0]</span>
<span class="go"> [529  66  67 ...   0   0   0]</span>
<span class="go"> [537  62  59 ...   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Switch to a FCFM policy:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">EFiltering</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">base_policy</span><span class="o">=</span><span class="s1">&#39;fcfm&#39;</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span>
<span class="go">Arrivals: [162 342 348 148]</span>
<span class="go">Traffic: [  1 158 189 147   1]</span>
<span class="go">Queues: [[569  99 118 ...   0   0   0]</span>
<span class="go"> [569  35  37 ...   0   0   0]</span>
<span class="go"> [528  58  57 ...   0   0   0]</span>
<span class="go"> [551  84  98 ...   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Switch to virtual queue:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">EFiltering</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">base_policy</span><span class="o">=</span><span class="s1">&#39;virtual_queue&#39;</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span>
<span class="go">Arrivals: [162 342 348 148]</span>
<span class="go">Traffic: [  0 157 186 144   1]</span>
<span class="go">Queues: [[311  93 110 ...   0   0   0]</span>
<span class="go"> [108 120 111 ...   0   0   0]</span>
<span class="go"> [ 67 113  76 ...   0   0   0]</span>
<span class="go"> [174 142 137 ...   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Stolyar’s example to see the behavior on hypergraph:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stol</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">incidence</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">.8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">EFiltering</span><span class="p">(</span><span class="n">stol</span><span class="p">,</span> <span class="n">base_policy</span><span class="o">=</span><span class="s1">&#39;virtual_queue&#39;</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">.0001</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span>
<span class="go">Arrivals: [216 282 371 131]</span>
<span class="go">Traffic: [  0   0 311  76 213   0  55]</span>
<span class="go">Queues: [[ 30 114 181 ...   0   0   0]</span>
<span class="go"> [ 22  64 117 ...   0   0   0]</span>
<span class="go"> [ 24 590 217 ...   0   0   0]</span>
<span class="go"> [995   5   0 ...   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span> <span class="o">@</span> <span class="n">rewards</span><span class="p">)</span>
<span class="go">1913</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([3.577, 4.856, 1.65 , 0.005])</span>
</pre></div>
</div>
<p>To compare with, the original EGPD policy:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">VirtualQueue</span><span class="p">(</span><span class="n">stol</span><span class="p">,</span> <span class="n">rewards</span><span class="o">=</span><span class="n">rewards</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span>
<span class="go">Arrivals: [236 279 342 143]</span>
<span class="go">Traffic: [  0   0 100   3 139   0 140]</span>
<span class="go">Queues: [[  2   3   5 ...   0   0   0]</span>
<span class="go"> [844   8   6 ...   0   0   0]</span>
<span class="go"> [  0   1   3 ...   0   0   0]</span>
<span class="go"> [597 230  96 ...   0   0   0]]</span>
<span class="go">Steps done: 1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">logs</span><span class="o">.</span><span class="n">traffic</span> <span class="o">@</span> <span class="n">rewards</span><span class="p">)</span>
<span class="go">1781</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([54.439,  1.597, 78.51 ,  0.691])</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.e_filtering.EFiltering.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'e_filtering'</span></em><a class="headerlink" href="#stochastic_matching.simulator.e_filtering.EFiltering.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.e_filtering.EFiltering.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/e_filtering.html#EFiltering.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.e_filtering.EFiltering.run" title="Link to this definition">#</a></dt>
<dd><p>Run simulation.
Results are stored in the attribute <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator.logs" title="stochastic_matching.simulator.simulator.Simulator.logs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">logs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.e_filtering.EFiltering.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/e_filtering.html#EFiltering.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.e_filtering.EFiltering.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.e_filtering.expand_model">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.e_filtering.</span></span><span class="sig-name descname"><span class="pre">expand_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forbidden_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/e_filtering.html#expand_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.e_filtering.expand_model" title="Link to this definition">#</a></dt>
<dd><p>Prepares a model for epsilon-filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Initial model.</p></li>
<li><p><strong>forbidden_edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>) – “-/-” edges to remove in the expanded graph.</p></li>
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Probability to draw a “+” item.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>model</strong> – Expanded model with 2n nodes that emulates epsilon-coloring.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section class="tex2jax_ignore mathjax_ignore" id="module-stochastic_matching.simulator.parallel">
<span id="tools-for-batch-evaluations"></span><h1>Tools for batch evaluations<a class="headerlink" href="#module-stochastic_matching.simulator.parallel" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.Iterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">Iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#Iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.Iterator" title="Link to this definition">#</a></dt>
<dd><p>Provides an easy way to make a parameter vary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the argument to vary.</p></li>
<li><p><strong>values</strong> (<em>iterable</em>) – Values that the argument can take.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – <em>Display</em> name of the parameter</p></li>
<li><p><strong>process</strong> (<em>callable</em><em>, </em><em>optional</em>) – If you want to transform the value used, use this.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>kwarg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword argument to use.</p></li>
<li><p><strong>log</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – What you want to remind. By default, identical to kwarg.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Imagine one wants a parameter x2 to vary amongst squares of integers.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iterator</span> <span class="o">=</span> <span class="n">Iterator</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">kwarg</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
<span class="go">{&#39;x2&#39;: 0} {&#39;x2&#39;: 0}</span>
<span class="go">{&#39;x2&#39;: 1} {&#39;x2&#39;: 1}</span>
<span class="go">{&#39;x2&#39;: 4} {&#39;x2&#39;: 4}</span>
<span class="go">{&#39;x2&#39;: 9} {&#39;x2&#39;: 9}</span>
</pre></div>
</div>
<p>You can do the same thing by iterating over integers and apply a square method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">iterator</span> <span class="o">=</span> <span class="n">Iterator</span><span class="p">(</span><span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">kwarg</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
<span class="go">{&#39;x2&#39;: 0} {&#39;x&#39;: 0}</span>
<span class="go">{&#39;x2&#39;: 1} {&#39;x&#39;: 1}</span>
<span class="go">{&#39;x2&#39;: 4} {&#39;x&#39;: 2}</span>
<span class="go">{&#39;x2&#39;: 9} {&#39;x&#39;: 3}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.Runner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">Runner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#Runner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.Runner" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>) – Metrics to extract.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.SingleXP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">SingleXP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#SingleXP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.SingleXP" title="Link to this definition">#</a></dt>
<dd><p>Produce a single experiment, with possibly one variable parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the experiment.</p></li>
<li><p><strong>iterator</strong> (<a class="reference internal" href="#stochastic_matching.simulator.parallel.Iterator" title="stochastic_matching.simulator.parallel.Iterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code></a>, optional) – Argument that varies.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, optional) – Various (fixed) arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.XP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">XP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#XP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.XP" title="Link to this definition">#</a></dt>
<dd><p>Produce an experiment, with possibly one variable parameter.
Addition can be used to concatenate experiments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the experiment.</p></li>
<li><p><strong>iterator</strong> (<a class="reference internal" href="#stochastic_matching.simulator.parallel.Iterator" title="stochastic_matching.simulator.parallel.Iterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code></a>, optional) – Argument that varies.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, optional) – Various (fixed) arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.aggregate">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.aggregate" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>results</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>) – Computed results. Each entry is a dictionary associated to a given run.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All results are gathered by experiment name, then by varying input / metric if applicable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.cached">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">cached</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#cached"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.cached" title="Link to this definition">#</a></dt>
<dd><p>Enables functions that take a lot of time to compute to store their output on a file.</p>
<p>If the original function is called with an additional parameter <cite>cache_name</cite>, it will look for a file named
<cite>cache_name.pkl.gz</cite>. If it exists, it returns its content, otherwise it computes the results and
stores it is returned.</p>
<p>Additional parameter <cite>cache_path</cite> indicates where to look the file (default to current directory).</p>
<p>Additional parameter <cite>cache_overwrite</cite> forces to always compute the function even if the file exists.
Default to False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – Function to make cachable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function with three additional arguments: <cite>cache_name</cite>, <cite>cache_path</cite>, <cite>cache_overwrite</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tempfile</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemporaryDirectory</span> <span class="k">as</span> <span class="n">TmpDir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@cached</span>
<span class="gp">... </span><span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">TmpDir</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">content_before</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)]</span>
<span class="gp">... </span>    <span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">cache_name</span><span class="o">=</span><span class="s1">&#39;cube&#39;</span><span class="p">,</span> <span class="n">cache_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">content_after</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)]</span>
<span class="gp">... </span>    <span class="n">res2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">cache_name</span><span class="o">=</span><span class="s1">&#39;cube&#39;</span><span class="p">,</span> <span class="n">cache_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span> <span class="c1"># This does not run f!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res2</span>
<span class="go">27</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">content_before</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">content_after</span>
<span class="go">[&#39;cube.pkl.gz&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.do_nothing">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">do_nothing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#do_nothing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.do_nothing" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a>) – Something</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Same object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)">object</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.parallel.evaluate">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.parallel.</span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/parallel.html#evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.parallel.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate some experiments. Results can be cached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xps</strong> (<a class="reference internal" href="#stochastic_matching.simulator.parallel.XP" title="stochastic_matching.simulator.parallel.XP"><code class="xref py py-class docutils literal notranslate"><span class="pre">XP</span></code></a>) – Experiment(s) to run.</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, optional.) – Metrics to get.</p></li>
<li><p><strong>pool</strong> (<a class="reference external" href="https://multiprocess.readthedocs.io/en/stable/multiprocess.html#multiprocess.pool.Pool" title="(in multiprocess v0.70.18)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, optional.) – Existing pool of workers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the experiment(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="n">diamond</span><span class="p">,</span> <span class="s1">&#39;n_steps&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;rewards&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xp</span> <span class="o">=</span> <span class="n">XP</span><span class="p">(</span><span class="s1">&#39;Diamond&#39;</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">base</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">,</span> <span class="s1">&#39;steps_done&#39;</span><span class="p">,</span> <span class="s1">&#39;regret&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Diamond</span>
<span class="go">income: [216 304 293 187]</span>
<span class="go">steps_done: 1000</span>
<span class="go">regret: 0.088</span>
<span class="go">delay: 0.1634</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">q0</span><span class="p">(</span><span class="n">simu</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">simu</span><span class="o">.</span><span class="n">avg_queues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span> <span class="s1">&#39;avg_queues&#39;</span><span class="p">,</span> <span class="n">q0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;Diamond&#39;</span><span class="p">][</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span>
<span class="go">array([1.19, 0.97, 0.97, 0.88, 0.99])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;Diamond&#39;</span><span class="p">][</span><span class="s1">&#39;avg_queues&#39;</span><span class="p">]</span>
<span class="go">array([0.531, 0.214, 0.273, 0.616])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;Diamond&#39;</span><span class="p">][</span><span class="s1">&#39;q0&#39;</span><span class="p">]</span>
<span class="go">np.float64(0.531)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xp1</span> <span class="o">=</span> <span class="n">XP</span><span class="p">(</span><span class="s1">&#39;e-filtering&#39;</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="s1">&#39;e_filtering&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">base</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">iterator</span><span class="o">=</span><span class="n">Iterator</span><span class="p">(</span><span class="s1">&#39;epsilon&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xp2</span> <span class="o">=</span> <span class="n">XP</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;k-filtering&#39;</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="s1">&#39;longest&#39;</span><span class="p">,</span> <span class="n">forbidden_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">iterator</span><span class="o">=</span><span class="n">Iterator</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">]),</span> <span class="o">**</span><span class="n">base</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xp3</span> <span class="o">=</span> <span class="n">XP</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;egpd&#39;</span><span class="p">,</span> <span class="n">simulator</span><span class="o">=</span><span class="s1">&#39;virtual_queue&#39;</span><span class="p">,</span>
<span class="gp">... </span>         <span class="n">iterator</span><span class="o">=</span><span class="n">Iterator</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="o">**</span><span class="n">base</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xp</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">xp1</span><span class="p">,</span> <span class="n">xp2</span><span class="p">,</span> <span class="n">xp3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocess</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">res</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;regret&#39;</span><span class="p">,</span> <span class="s1">&#39;delay&#39;</span><span class="p">],</span> <span class="n">pool</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">e-filtering</span>
<span class="go">e: [0.01 0.1  1.  ]</span>
<span class="go">regret: [0.002 0.017 0.103]</span>
<span class="go">delay: [1.0538 0.695  0.1952]</span>
<span class="go">k-filtering</span>
<span class="go">k: [  0  10 100]</span>
<span class="go">regret: [ 8.8000000e-02  2.0000000e-03 -8.8817842e-16]</span>
<span class="go">delay: [0.1634 0.7342 1.3542]</span>
<span class="go">egpd</span>
<span class="go">beta: [0.01 0.1  1.  ]</span>
<span class="go">regret: [0.003 0.043 0.076]</span>
<span class="go">delay: [9.2024 1.013  0.1888]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section class="tex2jax_ignore mathjax_ignore" id="module-stochastic_matching.simulator.metrics">
<span id="metrics"></span><h1>Metrics<a class="headerlink" href="#module-stochastic_matching.simulator.metrics" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.AvgQueues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">AvgQueues</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#AvgQueues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.AvgQueues" title="Link to this definition">#</a></dt>
<dd><p>Average queue size per item class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.AvgQueues.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#AvgQueues.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.AvgQueues.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.CCDF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">CCDF</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#CCDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.CCDF" title="Link to this definition">#</a></dt>
<dd><p>Complementary Cumulative Distribution Function of queue size for each item class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.CCDF.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#CCDF.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.CCDF.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Delay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">Delay</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Delay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Delay" title="Link to this definition">#</a></dt>
<dd><p>Average waiting time (i.e. average total queue size divided by global arrival rate).</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Delay.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Delay.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Delay.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Flow">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">Flow</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Flow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Flow" title="Link to this definition">#</a></dt>
<dd><p>Edge matching rate.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Flow.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Flow.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Flow.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Income">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">Income</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Income"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Income" title="Link to this definition">#</a></dt>
<dd><p>Number of arrived items per class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Income.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Income.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Income.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Metric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">Metric</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Metric" title="Link to this definition">#</a></dt>
<dd><p>Blueprint for extracting a metric from the simulator.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Metric.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Metric.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Metric.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Regret">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">Regret</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Regret"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Regret" title="Link to this definition">#</a></dt>
<dd><p>Given the matched items observed, difference between the best possible match
between these items and the actual match.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Regret depends on the assigned rewards.</p></li>
<li><p>Unmatched items are ignored to avoid side effects (e.g. if the optimal allocation is
unstable, for example because of negative weights).</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Regret.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Regret.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Regret.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.StepsDone">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">StepsDone</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#StepsDone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.StepsDone" title="Link to this definition">#</a></dt>
<dd><p>Simulation duration.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.StepsDone.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#StepsDone.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.StepsDone.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Traffic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">Traffic</span></span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Traffic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Traffic" title="Link to this definition">#</a></dt>
<dd><p>Matched edges.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.Traffic.get">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#Traffic.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.Traffic.get" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A metric.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.metrics.get_metrics">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.metrics.</span></span><span class="sig-name descname"><span class="pre">get_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/metrics.html#get_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.metrics.get_metrics" title="Link to this definition">#</a></dt>
<dd><p>Extraction of metrics from a simulator. Metrics can be:</p>
<ul class="simple">
<li><p>Name of a <a class="reference internal" href="#stochastic_matching.simulator.metrics.Metric" title="stochastic_matching.simulator.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> subclass</p></li>
<li><p>A <a class="reference internal" href="#stochastic_matching.simulator.metrics.Metric" title="stochastic_matching.simulator.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> subclass</p></li>
<li><p>A callable that takes a <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a> as input
(the name will be the name of the callable)</p></li>
<li><p>A list of metrics defined as above</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simu</strong> (<a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>) – Simulator to use.</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference internal" href="#stochastic_matching.simulator.metrics.Metric" title="stochastic_matching.simulator.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or callable.) – Metric(s) to extract.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<section class="tex2jax_ignore mathjax_ignore" id="module-stochastic_matching.simulator.fcfm">
<span id="first-come-first-served"></span><h1>First-Come First Served<a class="headerlink" href="#module-stochastic_matching.simulator.fcfm" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.fcfm.FCFM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.fcfm.</span></span><span class="sig-name descname"><span class="pre">FCFM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_queue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/fcfm.html#FCFM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.fcfm.FCFM" title="Link to this definition">#</a></dt>
<dd><p>Greedy Matching simulator derived from <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>.
When multiple choices are possible, the oldest item is chosen.</p>
<p class="rubric">Examples</p>
<p>Let start with a working triangle. One can notice the results are the same for all greedy simulator because
there are no multiple choices in a triangle (always one non-empty queue at most under a greedy policy).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">FCFM</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [287 338 375]</span>
<span class="go">Traffic: [125 162 213]</span>
<span class="go">Queues: [[838 104  41  13   3   1   0   0   0   0]</span>
<span class="go"> [796 119  53  22   8   2   0   0   0   0]</span>
<span class="go"> [640 176  92  51  24   9   5   3   0   0]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>Unstable diamond (simulation ends before completion due to drift).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">FCFM</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [85 82 85 86]</span>
<span class="go">Traffic: [34 42  7 41 36]</span>
<span class="go">Queues: [[126  70  22  26  29  12  23  15  10   5]</span>
<span class="go"> [326   8   3   1   0   0   0   0   0   0]</span>
<span class="go"> [321  12   4   1   0   0   0   0   0   0]</span>
<span class="go"> [105  80  65  28  31  15   4   2   6   2]]</span>
<span class="go">Steps done: 338</span>
</pre></div>
</div>
<p>A stable candy (but candies are not good for greedy policies).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">FCFM</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">HyperPaddle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>           <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [46 26 32 37 70 35 45]</span>
<span class="go">Traffic: [24 17  2 23 33 12 13]</span>
<span class="go">Queues: [[ 23  32  45  38  22  43  31  34  20   3   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [290   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [290   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [ 9   1   7   9   3   3  26  37   4   8  10   9   2  10  40  11   2  16</span>
<span class="go">    3   3  21  27  22   1   7]</span>
<span class="go"> [212  49  22   5   3   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [233  41   6   7   4   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [231  33  16   4   6   1   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 291</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.fcfm.FCFM.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'fcfm'</span></em><a class="headerlink" href="#stochastic_matching.simulator.fcfm.FCFM.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.fcfm.FCFM.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/fcfm.html#FCFM.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.fcfm.FCFM.run" title="Link to this definition">#</a></dt>
<dd><p>Run simulation.
Results are stored in the attribute <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator.logs" title="stochastic_matching.simulator.simulator.Simulator.logs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">logs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.fcfm.FCFM.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/fcfm.html#FCFM.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.fcfm.FCFM.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.fcfm.fcfm_core">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.fcfm.</span></span><span class="sig-name descname"><span class="pre">fcfm_core</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrivals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queues</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/fcfm.html#fcfm_core"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.fcfm.fcfm_core" title="Link to this definition">#</a></dt>
<dd><p>Jitted function for first-come, first-matched policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs</strong> (<a class="reference internal" href="#stochastic_matching.simulator.logs.Logs" title="stochastic_matching.simulator.logs.Logs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logs</span></code></a>) – Monitored variables.</p></li>
<li><p><strong>arrivals</strong> (<a class="reference internal" href="#stochastic_matching.simulator.arrivals.Arrivals" title="stochastic_matching.simulator.arrivals.Arrivals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Arrivals</span></code></a>) – Item arrival process.</p></li>
<li><p><strong>graph</strong> (<a class="reference internal" href="#stochastic_matching.simulator.graph.JitHyperGraph" title="stochastic_matching.simulator.graph.JitHyperGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">JitHyperGraph</span></code></a>) – Model graph.</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of arrivals to process.</p></li>
<li><p><strong>queue_size</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Number of waiting items of each class.</p></li>
<li><p><strong>queues</strong> (<a class="reference internal" href="#stochastic_matching.simulator.multiqueue.MultiQueue" title="stochastic_matching.simulator.multiqueue.MultiQueue"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiQueue</span></code></a>) – Waiting items of each class.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section class="tex2jax_ignore mathjax_ignore" id="module-stochastic_matching.simulator.priority">
<span id="other-policies"></span><h1>Other policies<a class="headerlink" href="#module-stochastic_matching.simulator.priority" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.priority.Priority">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.priority.</span></span><span class="sig-name descname"><span class="pre">Priority</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counterweights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/priority.html#Priority"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.priority.Priority" title="Link to this definition">#</a></dt>
<dd><p>Greedy policy based on pre-determined preferences on edges.</p>
<p>A threshold can be specified to alter the weights if the queue sizes get too big.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Priorities associated to the edges.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Limit on max queue size to apply the weight priority.</p></li>
<li><p><strong>counterweights</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, optional) – Priority to use above threshold (if not provided, reverse weights is used).</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">KayakPaddle</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">threshold</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">counterweights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>These priorities are efficient at stabilizing the policy while avoiding edge 3.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([2.925 , 1.0404, 0.9522, 0.    , 0.9504, 2.0808, 1.0044])</span>
</pre></div>
</div>
<p>The last node is the pseudo-instable node.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">avg_queues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">np.float64(38.346)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fish</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">avg_queues</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">np.float64(0.75)</span>
</pre></div>
</div>
<p>Choosing proper counter-weights is important.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">threshold</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span><span class="o">.</span><span class="n">simulation</span>
<span class="go">array([2.9232, 1.0422, 0.9504, 0.216 , 0.7344, 1.8666, 1.2186])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fish</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">avg_queues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">np.float64(38.6016)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.priority.Priority.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'priority'</span></em><a class="headerlink" href="#stochastic_matching.simulator.priority.Priority.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.priority.Priority.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/priority.html#Priority.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.priority.Priority.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.priority.make_priority_selector">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.priority.</span></span><span class="sig-name descname"><span class="pre">make_priority_selector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counterweights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/priority.html#make_priority_selector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.priority.make_priority_selector" title="Link to this definition">#</a></dt>
<dd><p>Make a jitted edge selector based on priorities.</p>
</dd></dl>

<dl class="py class" id="module-stochastic_matching.simulator.random_edge">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_edge.RandomEdge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.random_edge.</span></span><span class="sig-name descname"><span class="pre">RandomEdge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_queue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/random_edge.html#RandomEdge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.random_edge.RandomEdge" title="Link to this definition">#</a></dt>
<dd><p>Greedy Matching simulator derived from <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>.
When multiple choices are possible, one edge is chosen uniformly at random.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let start with a working triangle. One can notice the results are not the than for other greedy simulators.
This may seem off because there are no multiple choices in a triangle
(always one non-empty queue at most under a greedy policy).
The root cause is that the arrival process shares the same random generator than the random selection.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">triangle</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">RandomEdge</span><span class="p">(</span><span class="n">triangle</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [276 342 382]</span>
<span class="go">Traffic: [118 158 224]</span>
<span class="go">Queues: [[865  92  32  10   1   0   0   0   0   0   0]</span>
<span class="go"> [750 142  62  28  12   3   2   1   0   0   0]</span>
<span class="go"> [662 164  73  36  21   7  10  12   8   5   2]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<blockquote>
<div><p>Sanity check: results are unchanged if the graph is treated as hypergraph.</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">triangle</span><span class="o">.</span><span class="n">adjacency</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">RandomEdge</span><span class="p">(</span><span class="n">triangle</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [276 342 382]</span>
<span class="go">Traffic: [118 158 224]</span>
<span class="go">Queues: [[865  92  32  10   1   0   0   0   0   0   0]</span>
<span class="go"> [750 142  62  28  12   3   2   1   0   0   0]</span>
<span class="go"> [662 164  73  36  21   7  10  12   8   5   2]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>An ill diamond graph (simulation ends before completion due to drift).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">RandomEdge</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [24 20 16 23]</span>
<span class="go">Traffic: [10  8  2  8  6]</span>
<span class="go">Queues: [[ 9  4  7 13  5  5 10 24  5  1]</span>
<span class="go"> [83  0  0  0  0  0  0  0  0  0]</span>
<span class="go"> [76  4  3  0  0  0  0  0  0  0]</span>
<span class="go"> [13  8 15 19 14  8  2  1  2  1]]</span>
<span class="go">Steps done: 83</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">flow</span>
<span class="go">array([0.48192771, 0.38554217, 0.09638554, 0.38554217, 0.28915663])</span>
</pre></div>
</div>
<p>A working candy (but candies are not good for greedy policies).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">RandomEdge</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">HyperPaddle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [47 43 67 50 92 47 54]</span>
<span class="go">Traffic: [24 22 19 28 35 19 26]</span>
<span class="go">Queues: [[305  77  15   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [305  53  32   9   1   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [341  36  18   5   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [  7   6   9  13   7  34  41  47  23   9   2   3   2   7   6   2  12  46</span>
<span class="go">   16  14  39  43   2   5   5]</span>
<span class="go"> [275  51  38  30   6   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [324  50  21   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [305  47  23   9   2   3   5   5   1   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 400</span>
</pre></div>
</div>
<p>Note that you can reset the simulator before starting another run.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [47 43 67 50 92 47 54]</span>
<span class="go">Traffic: [24 22 19 28 35 19 26]</span>
<span class="go">Queues: [[305  77  15   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [305  53  32   9   1   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [341  36  18   5   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [  7   6   9  13   7  34  41  47  23   9   2   3   2   7   6   2  12  46</span>
<span class="go">   16  14  39  43   2   5   5]</span>
<span class="go"> [275  51  38  30   6   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [324  50  21   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [305  47  23   9   2   3   5   5   1   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 400</span>
</pre></div>
</div>
<p>You can display the distribution of queue sizes as a ccdf:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">show_ccdf</span><span class="p">()</span> 
<span class="go">&lt;Figure size ...x... with 1 Axes&gt;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_edge.RandomEdge.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'random_edge'</span></em><a class="headerlink" href="#stochastic_matching.simulator.random_edge.RandomEdge.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_edge.RandomEdge.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/random_edge.html#RandomEdge.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.random_edge.RandomEdge.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_edge.random_edge_selector">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.random_edge.</span></span><span class="sig-name descname"><span class="pre">random_edge_selector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/random_edge.html#random_edge_selector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.random_edge.random_edge_selector" title="Link to this definition">#</a></dt>
<dd><p>Selects a feasible edge at random.</p>
</dd></dl>

<dl class="py class" id="module-stochastic_matching.simulator.random_item">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_item.RandomItem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.random_item.</span></span><span class="sig-name descname"><span class="pre">RandomItem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_queue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/random_item.html#RandomItem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.random_item.RandomItem" title="Link to this definition">#</a></dt>
<dd><p>Greedy matching simulator derived from <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a>.
When multiple choices are possible, chooses proportionally to the sizes of the queues
(or sum of queues for hyperedges).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let start with a working triangle.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">RandomItem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">Cycle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [276 342 382]</span>
<span class="go">Traffic: [118 158 224]</span>
<span class="go">Queues: [[865  92  32  10   1   0   0   0   0   0   0]</span>
<span class="go"> [750 142  62  28  12   3   2   1   0   0   0]</span>
<span class="go"> [662 164  73  36  21   7  10  12   8   5   2]]</span>
<span class="go">Steps done: 1000</span>
</pre></div>
</div>
<p>An ill braess graph (simulation ends before completion due to drift).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">RandomItem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [25 17 13 12]</span>
<span class="go">Traffic: [10  6  2  5  5]</span>
<span class="go">Queues: [[ 9  4  7  7  5  4  9  8 11  3]</span>
<span class="go"> [67  0  0  0  0  0  0  0  0  0]</span>
<span class="go"> [60  4  3  0  0  0  0  0  0  0]</span>
<span class="go"> [15 18 16  9  4  5  0  0  0  0]]</span>
<span class="go">Steps done: 67</span>
</pre></div>
</div>
<p>A working candy (but candies are not good for greedy policies).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">RandomItem</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">HyperPaddle</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [112 106 166 105 206 112 115]</span>
<span class="go">Traffic: [66 46 39 61 64 51 81]</span>
<span class="go">Queues: [[683 125  63  25   8  13   2   3   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [659 130  65  34  32   2   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [757  89  36  19  12   9   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [ 23  10  23  30  28  56  56 109  81  85 114  55  22  38  17  36  32  30</span>
<span class="go">    7   4   3   5  13  20  25]</span>
<span class="go"> [673 123  73  28  19   6   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [769 112  33   4   4   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]</span>
<span class="go"> [708 122  55  17   4   5   5   5   1   0   0   0   0   0   0   0   0   0</span>
<span class="go">    0   0   0   0   0   0   0]]</span>
<span class="go">Steps done: 922</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_item.RandomItem.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'random_item'</span></em><a class="headerlink" href="#stochastic_matching.simulator.random_item.RandomItem.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_item.RandomItem.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/random_item.html#RandomItem.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.random_item.RandomItem.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.random_item.random_item_selector">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.random_item.</span></span><span class="sig-name descname"><span class="pre">random_item_selector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/random_item.html#random_item_selector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.random_item.random_item_selector" title="Link to this definition">#</a></dt>
<dd><p>Selects a feasible edge at random proportionally to the number of waiting items.</p>
</dd></dl>

<section id="generic-class">
<h2>Generic Class<a class="headerlink" href="#generic-class" title="Link to this heading">#</a></h2>
<p>The root abstract class for all simulators.</p>
<dl class="py class" id="module-stochastic_matching.simulator.simulator">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.simulator.</span></span><span class="sig-name descname"><span class="pre">Simulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_queue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/simulator.html#Simulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator" title="Link to this definition">#</a></dt>
<dd><p>Abstract class that describes the generic behavior of matching simulators.
See subclasses for detailed examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Number of arrivals to simulate.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Seed of the random generator</p></li>
<li><p><strong>max_queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Max queue size. Necessary for speed and detection of unstability.
For stable systems very close to the unstability
border, the max_queue may be reached.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.internal">
<span class="sig-name descname"><span class="pre">internal</span></span><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.internal" title="Link to this definition">#</a></dt>
<dd><p>Inner variables. Default to arrivals, graphs, queue_size, n_steps. Subclasses can add other variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.logs">
<span class="sig-name descname"><span class="pre">logs</span></span><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.logs" title="Link to this definition">#</a></dt>
<dd><p>Monitored variables (traffic on edges, queue size distribution, number of steps achieved).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stochastic_matching.simulator.logs.Logs" title="stochastic_matching.simulator.logs.Logs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logs</span></code></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">stochastic_matching</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">FCFM</span><span class="p">(</span><span class="n">sm</span><span class="o">.</span><span class="n">CycleChain</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span>
<span class="go">Simulator of type fcfm.</span>
</pre></div>
</div>
<p>Use <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator.run" title="stochastic_matching.simulator.simulator.Simulator.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> to make the simulation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Raw results are stored in <cite>logs</cite>. A <cite>plog</cite> property gives a pretty print of the logs.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">plogs</span> 
<span class="go">Arrivals: [67 80 43 39]</span>
<span class="go">Traffic: [43 17 14 23 12]</span>
<span class="go">Queues: [[118  47  26  15  14   7   1   1]</span>
<span class="go"> [188  25  13   3   0   0   0   0]</span>
<span class="go"> [217   8   3   1   0   0   0   0]</span>
<span class="go"> [125  50  31  11   9   3   0   0]]</span>
<span class="go">Steps done: 229</span>
</pre></div>
</div>
<p>Different methods are proposed to provide various indicators.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">avg_queues</span>
<span class="go">array([1.08296943, 0.26200873, 0.07423581, 0.8558952 ])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">delay</span>
<span class="go">np.float64(0.3669530919847866)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">ccdf</span> 
<span class="go">array([[1.        , 0.48471616, 0.27947598, 0.16593886, 0.10043668,</span>
<span class="go">        0.03930131, 0.00873362, 0.00436681, 0.        ],</span>
<span class="go">       [1.        , 0.1790393 , 0.069869  , 0.01310044, 0.        ,</span>
<span class="go">        0.        , 0.        , 0.        , 0.        ],</span>
<span class="go">       [1.        , 0.05240175, 0.01746725, 0.00436681, 0.        ,</span>
<span class="go">        0.        , 0.        , 0.        , 0.        ],</span>
<span class="go">       [1.        , 0.45414847, 0.23580786, 0.10043668, 0.05240175,</span>
<span class="go">        0.01310044, 0.        , 0.        , 0.        ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim</span><span class="o">.</span><span class="n">flow</span>
<span class="go">array([1.16419214, 0.46026201, 0.3790393 , 0.62270742, 0.32489083])</span>
</pre></div>
</div>
<p>You can also draw the average or CCDF of the queues.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">show_average_queues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> 
<span class="go">&lt;Figure size ...x... with 1 Axes&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">show_average_queues</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> 
<span class="go">&lt;Figure size ...x... with 1 Axes&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">show_ccdf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> 
<span class="go">&lt;Figure size ...x... with 1 Axes&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">show_ccdf</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> 
<span class="go">&lt;Figure size ...x... with 1 Axes&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.avg_queues">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">avg_queues</span></span><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.avg_queues" title="Link to this definition">#</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>
Average queue sizes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.ccdf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ccdf</span></span><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.ccdf" title="Link to this definition">#</a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>
CCDFs of the queues.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.delay">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">delay</span></span><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.delay" title="Link to this definition">#</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>
Average waiting time</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.flow">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flow</span></span><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.flow" title="Link to this definition">#</a></dt>
<dd><p>Normalize the simulated flow.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flow on edges.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.name" title="Link to this definition">#</a></dt>
<dd><p>Name that can be used to list all non-abstract classes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.plogs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plogs</span></span><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.plogs" title="Link to this definition">#</a></dt>
<dd><p>Print logs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/simulator.html#Simulator.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.reset" title="Link to this definition">#</a></dt>
<dd><p>Reset internal state and monitored variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/simulator.html#Simulator.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.run" title="Link to this definition">#</a></dt>
<dd><p>Run simulation.
Results are stored in the attribute <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator.logs" title="stochastic_matching.simulator.simulator.Simulator.logs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">logs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/simulator.html#Simulator.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.show_average_queues">
<span class="sig-name descname"><span class="pre">show_average_queues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/simulator.html#Simulator.show_average_queues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.show_average_queues" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, optional) – Indices of the nodes to display</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – If True, display the nodes by decreasing average queue size</p></li>
<li><p><strong>as_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – If True, display the nodes by decreasing average queue size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A figure of the CCDFs of the queues.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.10.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Figure</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.Simulator.show_ccdf">
<span class="sig-name descname"><span class="pre">show_ccdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/simulator.html#Simulator.show_ccdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.simulator.Simulator.show_ccdf" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, optional) – Indices of the nodes to display</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – If True, order the nodes by decreasing average queue size</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, default = False) – Draws the curves as a true piece-wise function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A figure of the CCDFs of the queues.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.10.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Figure</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.simulator.core_simulator">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.simulator.</span></span><span class="sig-name descname"><span class="pre">core_simulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arrivals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/simulator.html#core_simulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.simulator.core_simulator" title="Link to this definition">#</a></dt>
<dd><p>Generic jitted function for queue-size based policies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs</strong> (<a class="reference internal" href="#stochastic_matching.simulator.logs.Logs" title="stochastic_matching.simulator.logs.Logs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logs</span></code></a>) – Monitored variables.</p></li>
<li><p><strong>arrivals</strong> (<a class="reference internal" href="#stochastic_matching.simulator.arrivals.Arrivals" title="stochastic_matching.simulator.arrivals.Arrivals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Arrivals</span></code></a>) – Item arrival process.</p></li>
<li><p><strong>graph</strong> (<a class="reference internal" href="#stochastic_matching.simulator.graph.JitHyperGraph" title="stochastic_matching.simulator.graph.JitHyperGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">JitHyperGraph</span></code></a>) – Model graph.</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of arrivals to process.</p></li>
<li><p><strong>queue_size</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Number of waiting items of each class.</p></li>
<li><p><strong>selector</strong> (<em>callable</em>) – Jitted function that selects edge (or not) based on graph, queue_size, and arriving node.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="extended-class">
<h2>Extended Class<a class="headerlink" href="#extended-class" title="Link to this heading">#</a></h2>
<p>Abstract extension designed for reaching polytope vertices.</p>
<dl class="py class" id="module-stochastic_matching.simulator.extended">
<dt class="sig sig-object py" id="stochastic_matching.simulator.extended.ExtendedSimulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.extended.</span></span><span class="sig-name descname"><span class="pre">ExtendedSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt_rewards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forbidden_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/extended.html#ExtendedSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.extended.ExtendedSimulator" title="Link to this definition">#</a></dt>
<dd><p>This extended (abstract) class of <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a> accepts
additional parameters designed to reach vertices of the stability polytope.</p>
<p>How these parameters are exactly used is determined by its sub-classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model to simulate.</p></li>
<li><p><strong>rewards</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>, optional) – Rewards associated to edges.</p></li>
<li><p><strong>alt_rewards</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Possible reward transformation.</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, optional) – Reward factor: each edge is given a default score 1/beta (small beta means higher reward impact).
Setting beta triggers reward-based scoring.</p></li>
<li><p><strong>forbidden_edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, or <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Edges that should not be used. If set to True, the list of forbidden edges is computed from the rewards.</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Limit on queue size to apply edge interdiction (enforce stability on injective-only vertices).</p></li>
<li><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>) – Keyword parameters of <a class="reference internal" href="#stochastic_matching.simulator.simulator.Simulator" title="stochastic_matching.simulator.simulator.Simulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulator</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stochastic_matching.simulator.extended.ExtendedSimulator.set_internal">
<span class="sig-name descname"><span class="pre">set_internal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/extended.html#ExtendedSimulator.set_internal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.extended.ExtendedSimulator.set_internal" title="Link to this definition">#</a></dt>
<dd><p>Populate the internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-stochastic_matching.simulator.arrivals">
<span id="internal-tools"></span><h2>Internal tools<a class="headerlink" href="#module-stochastic_matching.simulator.arrivals" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.arrivals.Arrivals">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.arrivals.</span></span><span class="sig-name descname"><span class="pre">Arrivals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/arrivals.html#Arrivals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.arrivals.Arrivals" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Arrival intensities.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Seed for random generator.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arrivals</span> <span class="o">=</span> <span class="n">Arrivals</span><span class="p">([</span><span class="mi">2</span> <span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrivals</span><span class="o">.</span><span class="n">prob</span>
<span class="go">array([1. , 1. , 1. , 0.5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arrivals</span><span class="o">.</span><span class="n">alias</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([0, 0, 0, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Counter</span><span class="p">([</span><span class="n">arrivals</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">800</span><span class="p">)])</span>
<span class="go">Counter({2: 291, 1: 210, 0: 208, 3: 91})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.arrivals.create_prob_alias">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.arrivals.</span></span><span class="sig-name descname"><span class="pre">create_prob_alias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/arrivals.html#create_prob_alias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.arrivals.create_prob_alias" title="Link to this definition">#</a></dt>
<dd><p>Prepare vector to draw a distribution with the alias method.</p>
<p>Based on <a class="reference external" href="https://www.keithschwarz.com/darts-dice-coins/">https://www.keithschwarz.com/darts-dice-coins/</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Arrival intensities.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>prob</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Probabilities to stay in the drawn bucket</p></li>
<li><p><strong>alias</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Redirection array</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">probas</span><span class="p">,</span> <span class="n">aliases</span> <span class="o">=</span> <span class="n">create_prob_alias</span><span class="p">([</span><span class="mi">2</span> <span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probas</span>
<span class="go">array([1. , 1. , 1. , 0.5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aliases</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([0, 0, 0, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class" id="module-stochastic_matching.simulator.graph">
<dt class="sig sig-object py" id="stochastic_matching.simulator.graph.JitHyperGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.graph.</span></span><span class="sig-name descname"><span class="pre">JitHyperGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/graph.html#JitHyperGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.graph.JitHyperGraph" title="Link to this definition">#</a></dt>
<dd><p>Jit compatible view of a (hyper)graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>incid_ind</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Indices of the incidence matrix.</p></li>
<li><p><strong>incid_ptr</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Pointers of the incidence matrix.</p></li>
<li><p><strong>coinc_ind</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Indices of the co-incidence matrix.</p></li>
<li><p><strong>coinc_ptr</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Pointers of the co-incidence matrix.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of nodes.</p></li>
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of (hyper)edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.graph.make_jit_graph">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.graph.</span></span><span class="sig-name descname"><span class="pre">make_jit_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/graph.html#make_jit_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.graph.make_jit_graph" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="model.html#stochastic_matching.model.Model" title="stochastic_matching.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model that contains an incidence matrix.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Jitted graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#stochastic_matching.simulator.graph.JitHyperGraph" title="stochastic_matching.simulator.graph.JitHyperGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">JitHyperGraph</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-stochastic_matching.simulator.multiqueue">
<dt class="sig sig-object py" id="stochastic_matching.simulator.multiqueue.FullMultiQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.multiqueue.</span></span><span class="sig-name descname"><span class="pre">FullMultiQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/multiqueue.html#FullMultiQueue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.multiqueue.FullMultiQueue" title="Link to this definition">#</a></dt>
<dd><p>A simple management of multi-class FCFM that supports add to tail
and pop from head over multiple item classes.
Each item must be characterized by a UNIQUE non-negative int (typically a timestamp).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of classes.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let’s populate a multiqueue.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queues</span> <span class="o">=</span> <span class="n">FullMultiQueue</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">cl</span><span class="p">,</span> <span class="n">stamp</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]:</span>
<span class="gp">... </span>    <span class="n">queues</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cl</span><span class="p">,</span> <span class="n">stamp</span><span class="p">)</span>
</pre></div>
</div>
<p>Oldest items per class (infinity indicates an empty queue):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">queues</span><span class="o">.</span><span class="n">oldest</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[2, 4, 9223372036854775807, 0]</span>
</pre></div>
</div>
<p>Let’s remove some item. Note that pop returns nothing.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">queues</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="go">[None, None, None, None]</span>
</pre></div>
</div>
<p>Oldest items per class (infinity indicates an empty queue):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">queues</span><span class="o">.</span><span class="n">oldest</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[5, 9223372036854775807, 9223372036854775807, 6]</span>
</pre></div>
</div>
<p>Note that trying to pop from an empty queue will raise an error:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queues</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">9223372036854775807</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.multiqueue.MultiQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.multiqueue.</span></span><span class="sig-name descname"><span class="pre">MultiQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/multiqueue.html#MultiQueue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.multiqueue.MultiQueue" title="Link to this definition">#</a></dt>
<dd><p>A cruder, faster implementation of FullMultiQueue. Queues must be explicitly bounded on initialisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of classes.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Let’s populate a multiqueue and play with it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queues</span> <span class="o">=</span> <span class="n">MultiQueue</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_queue</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">queues</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">queues</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[2, 1, 0, 3]</span>
</pre></div>
</div>
<p>The age of the oldest element of an empty queue is infinity.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">queues</span><span class="o">.</span><span class="n">oldest</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[2, 4, 9223372036854775807, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queues</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">queues</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[2, 1, 0, 4]</span>
</pre></div>
</div>
<p>Trying to go above the max queue raises an error (item is not added, queue stays viable):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queues</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OverflowError</span>: <span class="n">Max queue size reached.</span>
</pre></div>
</div>
<p>So does trying to pop something empty (and queue stays viable).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">queues</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Try to pop an empty queue</span>
</pre></div>
</div>
<p>Let’s play a bit more.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">queues</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">queues</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[1, 0, 0, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">queues</span><span class="o">.</span><span class="n">oldest</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[5, 9223372036854775807, 9223372036854775807, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">30</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Add </span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s2"> to class 3.&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">queues</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Oldest of class 3 is </span><span class="si">{</span><span class="n">queues</span><span class="o">.</span><span class="n">oldest</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">, we pop it.&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">queues</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Add 22 to class 3.</span>
<span class="go">Oldest of class 3 is 6, we pop it.</span>
<span class="go">Add 23 to class 3.</span>
<span class="go">Oldest of class 3 is 10, we pop it.</span>
<span class="go">Add 24 to class 3.</span>
<span class="go">Oldest of class 3 is 22, we pop it.</span>
<span class="go">Add 25 to class 3.</span>
<span class="go">Oldest of class 3 is 23, we pop it.</span>
<span class="go">Add 26 to class 3.</span>
<span class="go">Oldest of class 3 is 24, we pop it.</span>
<span class="go">Add 27 to class 3.</span>
<span class="go">Oldest of class 3 is 25, we pop it.</span>
<span class="go">Add 28 to class 3.</span>
<span class="go">Oldest of class 3 is 26, we pop it.</span>
<span class="go">Add 29 to class 3.</span>
<span class="go">Oldest of class 3 is 27, we pop it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">queues</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[1, 0, 0, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">queues</span><span class="o">.</span><span class="n">oldest</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
<span class="go">[5, 9223372036854775807, 9223372036854775807, 28]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class" id="module-stochastic_matching.simulator.logs">
<dt class="sig sig-object py" id="stochastic_matching.simulator.logs.Logs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.logs.</span></span><span class="sig-name descname"><span class="pre">Logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/logs.html#Logs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.logs.Logs" title="Link to this definition">#</a></dt>
<dd><p>Jitclass for logs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of nodes.</p></li>
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of edges.</p></li>
<li><p><strong>max_queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Maximum number of items per class.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stochastic_matching.simulator.logs.PhantomLogs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.logs.</span></span><span class="sig-name descname"><span class="pre">PhantomLogs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/logs.html#PhantomLogs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.logs.PhantomLogs" title="Link to this definition">#</a></dt>
<dd><p>Jitclass for logs of e-filtering policies. automatically concatenates the results in the original format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of nodes of the original graph.</p></li>
<li><p><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of edges of the original graph.</p></li>
<li><p><strong>max_queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Maximum number of items per class.</p></li>
<li><p><strong>edges</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>) – Edge index.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stochastic_matching.simulator.logs.repr_logs">
<span class="sig-prename descclassname"><span class="pre">stochastic_matching.simulator.logs.</span></span><span class="sig-name descname"><span class="pre">repr_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stochastic_matching/simulator/logs.html#repr_logs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stochastic_matching.simulator.logs.repr_logs" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logs</strong> (<a class="reference internal" href="#stochastic_matching.simulator.logs.Logs" title="stochastic_matching.simulator.logs.Logs"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logs</span></code></a>) – Logs to display. Relies on <cite>print</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="display.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Display</p>
      </div>
    </a>
    <a class="right-next"
       href="common.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Common</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Simulation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.longest">Longest queue(s) first</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.longest.Longest"><code class="docutils literal notranslate"><span class="pre">Longest</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.longest.Longest.name"><code class="docutils literal notranslate"><span class="pre">Longest.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.longest.Longest.run"><code class="docutils literal notranslate"><span class="pre">Longest.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.longest.Longest.set_internal"><code class="docutils literal notranslate"><span class="pre">Longest.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.longest.longest_core"><code class="docutils literal notranslate"><span class="pre">longest_core()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.virtual_queue">Virtual queue policy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue"><code class="docutils literal notranslate"><span class="pre">VirtualQueue</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue.name"><code class="docutils literal notranslate"><span class="pre">VirtualQueue.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue.run"><code class="docutils literal notranslate"><span class="pre">VirtualQueue.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.virtual_queue.VirtualQueue.set_internal"><code class="docutils literal notranslate"><span class="pre">VirtualQueue.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.virtual_queue.vq_core"><code class="docutils literal notranslate"><span class="pre">vq_core()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.constant_regret.ConstantRegret"><code class="docutils literal notranslate"><span class="pre">ConstantRegret</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.constant_regret.ConstantRegret.name"><code class="docutils literal notranslate"><span class="pre">ConstantRegret.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.constant_regret.ConstantRegret.run"><code class="docutils literal notranslate"><span class="pre">ConstantRegret.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.constant_regret.ConstantRegret.set_internal"><code class="docutils literal notranslate"><span class="pre">ConstantRegret.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.constant_regret.cr_core"><code class="docutils literal notranslate"><span class="pre">cr_core()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.constant_regret.lin_fading"><code class="docutils literal notranslate"><span class="pre">lin_fading()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.e_filtering">Epsilon-Filtering policy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.e_filtering.EFiltering"><code class="docutils literal notranslate"><span class="pre">EFiltering</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.e_filtering.EFiltering.name"><code class="docutils literal notranslate"><span class="pre">EFiltering.name</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.e_filtering.EFiltering.run"><code class="docutils literal notranslate"><span class="pre">EFiltering.run()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.e_filtering.EFiltering.set_internal"><code class="docutils literal notranslate"><span class="pre">EFiltering.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.e_filtering.expand_model"><code class="docutils literal notranslate"><span class="pre">expand_model()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.parallel">Tools for batch evaluations</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.Iterator"><code class="docutils literal notranslate"><span class="pre">Iterator</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.Runner"><code class="docutils literal notranslate"><span class="pre">Runner</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.SingleXP"><code class="docutils literal notranslate"><span class="pre">SingleXP</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.XP"><code class="docutils literal notranslate"><span class="pre">XP</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.aggregate"><code class="docutils literal notranslate"><span class="pre">aggregate()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.cached"><code class="docutils literal notranslate"><span class="pre">cached()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.do_nothing"><code class="docutils literal notranslate"><span class="pre">do_nothing()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.parallel.evaluate"><code class="docutils literal notranslate"><span class="pre">evaluate()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.metrics">Metrics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.AvgQueues"><code class="docutils literal notranslate"><span class="pre">AvgQueues</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.AvgQueues.get"><code class="docutils literal notranslate"><span class="pre">AvgQueues.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.CCDF"><code class="docutils literal notranslate"><span class="pre">CCDF</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.CCDF.get"><code class="docutils literal notranslate"><span class="pre">CCDF.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Delay"><code class="docutils literal notranslate"><span class="pre">Delay</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Delay.get"><code class="docutils literal notranslate"><span class="pre">Delay.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Flow"><code class="docutils literal notranslate"><span class="pre">Flow</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Flow.get"><code class="docutils literal notranslate"><span class="pre">Flow.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Income"><code class="docutils literal notranslate"><span class="pre">Income</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Income.get"><code class="docutils literal notranslate"><span class="pre">Income.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Metric"><code class="docutils literal notranslate"><span class="pre">Metric</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Metric.get"><code class="docutils literal notranslate"><span class="pre">Metric.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Regret"><code class="docutils literal notranslate"><span class="pre">Regret</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Regret.get"><code class="docutils literal notranslate"><span class="pre">Regret.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.StepsDone"><code class="docutils literal notranslate"><span class="pre">StepsDone</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.StepsDone.get"><code class="docutils literal notranslate"><span class="pre">StepsDone.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Traffic"><code class="docutils literal notranslate"><span class="pre">Traffic</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.Traffic.get"><code class="docutils literal notranslate"><span class="pre">Traffic.get()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.metrics.get_metrics"><code class="docutils literal notranslate"><span class="pre">get_metrics()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.fcfm">First-Come First Served</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.fcfm.FCFM"><code class="docutils literal notranslate"><span class="pre">FCFM</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.fcfm.FCFM.name"><code class="docutils literal notranslate"><span class="pre">FCFM.name</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.fcfm.FCFM.run"><code class="docutils literal notranslate"><span class="pre">FCFM.run()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.fcfm.FCFM.set_internal"><code class="docutils literal notranslate"><span class="pre">FCFM.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.fcfm.fcfm_core"><code class="docutils literal notranslate"><span class="pre">fcfm_core()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.priority">Other policies</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.priority.Priority"><code class="docutils literal notranslate"><span class="pre">Priority</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.priority.Priority.name"><code class="docutils literal notranslate"><span class="pre">Priority.name</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.priority.Priority.set_internal"><code class="docutils literal notranslate"><span class="pre">Priority.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.priority.make_priority_selector"><code class="docutils literal notranslate"><span class="pre">make_priority_selector()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_edge.RandomEdge"><code class="docutils literal notranslate"><span class="pre">RandomEdge</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_edge.RandomEdge.name"><code class="docutils literal notranslate"><span class="pre">RandomEdge.name</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_edge.RandomEdge.set_internal"><code class="docutils literal notranslate"><span class="pre">RandomEdge.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_edge.random_edge_selector"><code class="docutils literal notranslate"><span class="pre">random_edge_selector()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_item.RandomItem"><code class="docutils literal notranslate"><span class="pre">RandomItem</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_item.RandomItem.name"><code class="docutils literal notranslate"><span class="pre">RandomItem.name</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_item.RandomItem.set_internal"><code class="docutils literal notranslate"><span class="pre">RandomItem.set_internal()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.random_item.random_item_selector"><code class="docutils literal notranslate"><span class="pre">random_item_selector()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-class">Generic Class</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator"><code class="docutils literal notranslate"><span class="pre">Simulator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.internal"><code class="docutils literal notranslate"><span class="pre">Simulator.internal</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.logs"><code class="docutils literal notranslate"><span class="pre">Simulator.logs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.avg_queues"><code class="docutils literal notranslate"><span class="pre">Simulator.avg_queues</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.ccdf"><code class="docutils literal notranslate"><span class="pre">Simulator.ccdf</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.delay"><code class="docutils literal notranslate"><span class="pre">Simulator.delay</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.flow"><code class="docutils literal notranslate"><span class="pre">Simulator.flow</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.name"><code class="docutils literal notranslate"><span class="pre">Simulator.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.plogs"><code class="docutils literal notranslate"><span class="pre">Simulator.plogs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.reset"><code class="docutils literal notranslate"><span class="pre">Simulator.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.run"><code class="docutils literal notranslate"><span class="pre">Simulator.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.set_internal"><code class="docutils literal notranslate"><span class="pre">Simulator.set_internal()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.show_average_queues"><code class="docutils literal notranslate"><span class="pre">Simulator.show_average_queues()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.Simulator.show_ccdf"><code class="docutils literal notranslate"><span class="pre">Simulator.show_ccdf()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.simulator.core_simulator"><code class="docutils literal notranslate"><span class="pre">core_simulator()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-class">Extended Class</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.extended.ExtendedSimulator"><code class="docutils literal notranslate"><span class="pre">ExtendedSimulator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.extended.ExtendedSimulator.set_internal"><code class="docutils literal notranslate"><span class="pre">ExtendedSimulator.set_internal()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stochastic_matching.simulator.arrivals">Internal tools</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.arrivals.Arrivals"><code class="docutils literal notranslate"><span class="pre">Arrivals</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.arrivals.create_prob_alias"><code class="docutils literal notranslate"><span class="pre">create_prob_alias()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.graph.JitHyperGraph"><code class="docutils literal notranslate"><span class="pre">JitHyperGraph</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.graph.make_jit_graph"><code class="docutils literal notranslate"><span class="pre">make_jit_graph()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.multiqueue.FullMultiQueue"><code class="docutils literal notranslate"><span class="pre">FullMultiQueue</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.multiqueue.MultiQueue"><code class="docutils literal notranslate"><span class="pre">MultiQueue</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.logs.Logs"><code class="docutils literal notranslate"><span class="pre">Logs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.logs.PhantomLogs"><code class="docutils literal notranslate"><span class="pre">PhantomLogs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stochastic_matching.simulator.logs.repr_logs"><code class="docutils literal notranslate"><span class="pre">repr_logs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/simulator.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2022, Fabien Mathieu.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>